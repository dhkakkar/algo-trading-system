{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "id": 1,
      "title": "Active Trading Sessions",
      "type": "stat",
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 0 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT COUNT(*) AS \"Active Sessions\" FROM trading_sessions WHERE status = 'running';",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null },
              { "color": "green", "value": 1 }
            ]
          }
        },
        "overrides": []
      },
      "options": { "colorMode": "background", "reduceOptions": { "calcs": ["lastNotNull"] } }
    },
    {
      "id": 2,
      "title": "Total Sessions",
      "type": "stat",
      "gridPos": { "h": 4, "w": 6, "x": 6, "y": 0 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT COUNT(*) AS \"Total\" FROM trading_sessions;",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "purple", "value": null }]
          }
        },
        "overrides": []
      },
      "options": { "colorMode": "background", "reduceOptions": { "calcs": ["lastNotNull"] } }
    },
    {
      "id": 3,
      "title": "Total Trades (All Sessions)",
      "type": "stat",
      "gridPos": { "h": 4, "w": 6, "x": 12, "y": 0 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT COUNT(*) AS \"Total Trades\" FROM trades WHERE mode IN ('paper', 'live');",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "orange", "value": null }]
          }
        },
        "overrides": []
      },
      "options": { "colorMode": "background", "reduceOptions": { "calcs": ["lastNotNull"] } }
    },
    {
      "id": 4,
      "title": "Total Realized P&L",
      "type": "stat",
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 0 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT COALESCE(SUM(net_pnl), 0) AS \"Realized P&L\" FROM trades WHERE mode IN ('paper', 'live') AND exit_price IS NOT NULL;",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "unit": "currencyINR",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "green", "value": 0 }
            ]
          }
        },
        "overrides": []
      },
      "options": { "colorMode": "background", "reduceOptions": { "calcs": ["lastNotNull"] } }
    },
    {
      "id": 5,
      "title": "Sessions by Status",
      "type": "piechart",
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 4 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT status, COUNT(*) AS count FROM trading_sessions GROUP BY status ORDER BY count DESC;",
          "format": "table",
          "refId": "A"
        }
      ],
      "options": {
        "legend": { "displayMode": "table", "placement": "right" },
        "pieType": "donut",
        "reduceOptions": { "calcs": ["lastNotNull"] }
      }
    },
    {
      "id": 6,
      "title": "Sessions by Mode",
      "type": "piechart",
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 4 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT mode, COUNT(*) AS count FROM trading_sessions GROUP BY mode;",
          "format": "table",
          "refId": "A"
        }
      ],
      "options": {
        "legend": { "displayMode": "table", "placement": "right" },
        "pieType": "donut",
        "reduceOptions": { "calcs": ["lastNotNull"] }
      }
    },
    {
      "id": 7,
      "title": "Win Rate (Closed Trades)",
      "type": "gauge",
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 4 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT CASE WHEN COUNT(*) = 0 THEN 0 ELSE ROUND(100.0 * SUM(CASE WHEN net_pnl > 0 THEN 1 ELSE 0 END) / COUNT(*), 1) END AS \"Win Rate %\" FROM trades WHERE mode IN ('paper', 'live') AND exit_price IS NOT NULL;",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "yellow", "value": 40 },
              { "color": "green", "value": 55 }
            ]
          }
        },
        "overrides": []
      },
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] } }
    },
    {
      "id": 8,
      "title": "Recent Trades",
      "type": "table",
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 12 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT t.tradingsymbol AS \"Symbol\", t.exchange AS \"Exchange\", t.side AS \"Side\", t.quantity AS \"Qty\", t.entry_price AS \"Entry\", t.exit_price AS \"Exit\", t.net_pnl AS \"Net P&L\", t.pnl_percent AS \"P&L %\", t.charges AS \"Charges\", t.mode AS \"Mode\", t.entry_at AS \"Entry Time\", t.exit_at AS \"Exit Time\" FROM trades t WHERE t.mode IN ('paper', 'live') ORDER BY t.entry_at DESC LIMIT 50;",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Net P&L" },
            "properties": [
              { "id": "unit", "value": "currencyINR" },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    { "color": "red", "value": null },
                    { "color": "green", "value": 0 }
                  ]
                }
              },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } }
            ]
          }
        ]
      },
      "options": { "showHeader": true, "sortBy": [] }
    },
    {
      "id": 9,
      "title": "P&L by Symbol",
      "type": "barchart",
      "gridPos": { "h": 10, "w": 12, "x": 0, "y": 22 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT tradingsymbol AS \"Symbol\", COALESCE(SUM(net_pnl), 0) AS \"Total P&L\" FROM trades WHERE mode IN ('paper', 'live') AND exit_price IS NOT NULL GROUP BY tradingsymbol ORDER BY \"Total P&L\" DESC LIMIT 20;",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyINR",
          "color": { "mode": "thresholds" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "green", "value": 0 }
            ]
          }
        },
        "overrides": []
      },
      "options": { "xField": "Symbol", "orientation": "horizontal" }
    },
    {
      "id": 10,
      "title": "Daily P&L (Paper + Live)",
      "type": "timeseries",
      "gridPos": { "h": 10, "w": 12, "x": 12, "y": 22 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT DATE(exit_at) AS time, SUM(net_pnl) AS \"Daily P&L\" FROM trades WHERE mode IN ('paper', 'live') AND exit_price IS NOT NULL AND exit_at IS NOT NULL GROUP BY DATE(exit_at) ORDER BY time;",
          "format": "time_series",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyINR",
          "color": { "mode": "thresholds" },
          "custom": {
            "drawStyle": "bars",
            "fillOpacity": 80,
            "thresholdsStyle": { "mode": "line" }
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "green", "value": 0 }
            ]
          }
        },
        "overrides": []
      },
      "options": { "legend": { "displayMode": "list" } }
    },
    {
      "id": 11,
      "title": "Trading Sessions List",
      "type": "table",
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 32 },
      "datasource": { "type": "postgres", "uid": "" },
      "targets": [
        {
          "rawSql": "SELECT ts.id AS \"Session ID\", s.name AS \"Strategy\", ts.mode AS \"Mode\", ts.status AS \"Status\", ts.initial_capital AS \"Initial Capital\", ts.current_capital AS \"Current Capital\", COALESCE(ts.current_capital - ts.initial_capital, 0) AS \"P&L\", ts.timeframe AS \"Timeframe\", ts.started_at AS \"Started\", ts.stopped_at AS \"Stopped\", ts.created_at AS \"Created\" FROM trading_sessions ts LEFT JOIN strategies s ON ts.strategy_id = s.id ORDER BY ts.created_at DESC LIMIT 50;",
          "format": "table",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "P&L" },
            "properties": [
              { "id": "unit", "value": "currencyINR" },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    { "color": "red", "value": null },
                    { "color": "green", "value": 0 }
                  ]
                }
              },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Status" },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  { "type": "value", "options": { "running": { "text": "RUNNING", "color": "green" }, "stopped": { "text": "STOPPED", "color": "gray" }, "error": { "text": "ERROR", "color": "red" }, "paused": { "text": "PAUSED", "color": "yellow" } } }
                ]
              }
            ]
          }
        ]
      },
      "options": { "showHeader": true }
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": ["trading"],
  "templating": { "list": [] },
  "time": { "from": "now-30d", "to": "now" },
  "timepicker": {},
  "timezone": "Asia/Kolkata",
  "title": "Trading Overview",
  "uid": "trading-overview",
  "version": 1
}
